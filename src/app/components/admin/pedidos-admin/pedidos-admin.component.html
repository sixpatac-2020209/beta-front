<body>
  <main id="main" class="main">
    <div class="pagetitle">
      <h1>Pedidos</h1>
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a routerLink="/admin/home">Inicio</a>
          </li>
          <li class="breadcrumb-item active">Pedidos</li>
        </ol>
      </nav>
    </div>
    <section>
      <div>
        <div class="text-center">
          <button data-bs-toggle="modal" data-bs-target="#addOrden" class="btn icon-btn btn-success ms-2 me-2">
            <span style="border-radius: 50% 50%" class="btn-glyphicon fa fa-file text-success"></span>
            Agregar Orden
          </button>

          <button (click)="showFilters(); cleanFilters();" data-bs-toggle="modal" data-bs-target="#addOrden"
            class="btn icon-btn btn-primary ms-2 me-2">
            <span style="border-radius: 50% 50%" class="btn-glyphicon fa fa-file text-primary"></span>
            Filtrar Orden
          </button>

          <button mat-button [matMenuTriggerFor]="menu">Menu</button>
          <mat-menu #menu="matMenu">
            <div class="matAnMen" >
              <button mat-menu-item value="1">Item 1</button>
              <button mat-menu-item>Item 2</button>
            </div>
          </mat-menu>

          <div *ngIf="filtros" class="text-center mt-2">
            <button (click)="showYearFilter()" class="btn icon-btn btn-dark ms-3 me-3">
              <span style="border-radius: 50% 50%" class="btn-glyphicon fa-solid fa-calendar iconBotF"></span>
              AÑO
            </button>
            <button (click)="showMonthFilter()" class="btn icon-btn btn-dark ms-3 me-3">
              <span style="border-radius: 50% 50%" class="btn-glyphicon fa-solid fa-calendar-days iconBotF"></span>
              MES
            </button>
          </div>
        </div>
        <hr />
        <br />
        <div *ngIf="yearFiltro" class="formC">
          <form class="formC" id="yearForm" #yearForm="ngForm">
            <div class="contIntoForm">
              <mat-form-field class="">
                <input [(ngModel)]="pedido.YEAR" name="YEAR" class="toolbar-search" type="text" autocomplete="off"
                  matInput />
                <mat-placeholder>Año</mat-placeholder>
                <mat-icon matSuffix style="font-size: 1.2em">search</mat-icon>
              </mat-form-field>
            </div>
            <div class="contBot">
              <button (click)=" getPedidosPorA(yearForm); showTableYear(); " type="submit"
                class="btn btn-labeled btn-success me-1">
                <span class="btn-label">
                  <i class="fa-solid fa-magnifying-glass"></i>
                </span>
                Buscar
              </button>
              <button (click)=" cleanFilters(); showPrincipalTable(); " type="submit"
                class="btn btn-labeled btn-danger me-1">
                <span class="btn-label">
                  <i class="fa-solid fa-xmark"></i>
                </span>
                Cancelar
              </button>
            </div>
          </form>
        </div>

        <div *ngIf="monthFiltro">
          <form class="formC" id="monthForm" #monthForm="ngForm">
            <div class="contIntoForm">
              <mat-form-field class="">
                <input [(ngModel)]="pedido.YEAR" name="YEAR" class="toolbar-search" type="text" autocomplete="off"
                  matInput />
                <mat-placeholder>Año</mat-placeholder>
                <mat-icon matSuffix style="font-size: 1.2em">calendar_today</mat-icon>
              </mat-form-field>

              <mat-form-field class="">
                <input [(ngModel)]="pedido.MONTH" name="MONTH" class="toolbar-search" type="text" autocomplete="off"
                  matInput />
                <mat-placeholder>Mes</mat-placeholder>
                <mat-icon matSuffix style="font-size: 1.2em">calendar_today</mat-icon>
              </mat-form-field>
            </div>

            <div class="contBot">
              <button (click)="getPedidosPorMes(monthForm); showTableMonth();" type="submit"
                class="btn btn-labeled btn-success me-1">
                <span class="btn-label">
                  <i class="fa-solid fa-magnifying-glass"></i>
                </span>
                Buscar
              </button>
              <button (click)=" cleanFilters(); showPrincipalTable() " type="submit"
                class="btn btn-labeled btn-danger me-1">
                <span class="btn-label">
                  <i class="fa-solid fa-xmark"></i>
                </span>
                Cancelar
              </button>
            </div>
          </form>
        </div>


        <!--TABLA AÑO-->
        <div class="row clearfix tableText" *ngIf="yearTable">
          <h1>TABLA DE AÑO</h1>
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 tableText">
            <div class="card tableText">
              <div class="materialTableHeader mb-3 tableText headTab">
                <div class="row tableText">
                  <div class="col-8 tableText">
                    <div class="hola">
                      <ul class="header-buttons-left ml-0 tableTitle">
                        <li class="dropdown m-l-20">
                          <label for="search-input">
                            <i class="material-icons search-icon">search</i>
                          </label>
                          <input placeholder="Buscar Pedido..." type="text" #filter class="browser-default search-field"
                            aria-label="Search box" />
                        </li>
                      </ul>
                      <div style="float: right">
                        <button class="botonAc" (click)="exportExcel()">
                          <i style="color: green" class="fa-solid fa-file-excel"></i>
                          &nbsp; Excel
                        </button>
                        <button class="botonAc">
                          <i style="color: red" class="fa-solid fa-file-pdf"></i>
                          &nbsp; PDF
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="tableBody">
                <div class="table-responsive">
                  <table class="table table-bpedidoed table-hover">
                    <thead style="margin: -100px">
                      <tr>
                        <th class="text-center">#</th>
                        <th class="text-center">CVE_DOC</th>
                        <th class="text-center" style="width: 160px">
                          IMPORTE
                        </th>
                        <th class="text-center">CVE_CLPV</th>
                        <th class="text-center">Cliente</th>
                        <th class="text-center">CVE_VEND</th>
                        <th class="text-center">Vendedor</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let pedido of pedidosY">
                        <td>{{ pedidosY.indexOf(pedido) + 1 }}</td>
                        <td class="text-center" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          {{ pedido.CVE_DOC }}
                        </td>
                        <td style="text-align: right" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          <span style="text-align: right">{{ pedido.IMPORTE }}
                          </span>
                        </td>
                        <td class="text-center" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          {{ pedido.CVE_CLPV }}
                        </td>
                        <td (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal" data-bs-target="#viewUser">
                          {{ pedido.NOMBRE[0] }}
                        </td>
                        <td class="text-center" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          {{ pedido.CVE_VEND }}
                        </td>
                        <td (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal" data-bs-target="#viewUser">
                          {{ pedido.NOMBRE[1] }}
                        </td>
                      </tr>
                      <tr rowspan="9" *ngIf="notFound === true">
                        <td colspan="9" class="text-center">Sin Resultados</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>


        <!--TABLA MES-->
        <div class="row clearfix tableText" *ngIf="monthTable">
          <H1>TABLA DE cancelar</H1>
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 tableText">
            <div class="card tableText">
              <div class="materialTableHeader mb-3 tableText headTab">
                <div class="row tableText">
                  <div class="col-8 tableText">
                    <div class="hola">
                      <ul class="header-buttons-left ml-0 tableTitle">
                        <li class="dropdown m-l-20">
                          <label for="search-input">
                            <i class="material-icons search-icon">search</i>
                          </label>
                          <input placeholder="Buscar Pedido..." type="text" #filter class="browser-default search-field"
                            aria-label="Search box" />
                        </li>
                      </ul>
                      <div style="float: right">
                        <button class="botonAc" (click)="exportExcel()">
                          <i style="color: green" class="fa-solid fa-file-excel"></i>
                          &nbsp; Excel
                        </button>
                        <button class="botonAc">
                          <i style="color: red" class="fa-solid fa-file-pdf"></i>
                          &nbsp; PDF
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="tableBody">
                <div class="table-responsive">
                  <table class="table table-bpedidoed table-hover">
                    <thead style="margin: -100px">
                      <tr>
                        <th class="text-center">#</th>
                        <th class="text-center">CVE_DOC</th>
                        <th class="text-center" style="width: 160px">
                          IMPORTE
                        </th>
                        <th class="text-center">CVE_CLPV</th>
                        <th class="text-center">Cliente</th>
                        <th class="text-center">CVE_VEND</th>
                        <th class="text-center">Vendedor</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let pedido of pedidosPorMes">
                        <td>{{ pedidosPorMes.indexOf(pedido) + 1 }}</td>
                        <td class="text-center" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          {{ pedido.CVE_DOC }}
                        </td>
                        <td style="text-align: right" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          <span style="text-align: right">{{ pedido.IMPORTE }}
                          </span>
                        </td>
                        <td class="text-center" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          {{ pedido.CVE_CLPV }}
                        </td>
                        <td (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal" data-bs-target="#viewUser">
                          {{ pedido.NOMBRE[0] }}
                        </td>
                        <td class="text-center" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          {{ pedido.CVE_VEND }}
                        </td>
                        <td (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal" data-bs-target="#viewUser">
                          {{ pedido.NOMBRE[1] }}
                        </td>
                      </tr>
                      <tr rowspan="9" *ngIf="notFound === true">
                        <td colspan="9" class="text-center">Sin Resultados</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>


        <!--TABLA PRINCIPAL-->
        <div class="row clearfix tableText" *ngIf="!principalTable">
          <H1>TABLA PRINCIPAL</H1>
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 tableText">
            <div class="card tableText">
              <div class="materialTableHeader mb-3 tableText headTab">
                <div class="row tableText">
                  <div class="col-8 tableText">
                    <div class="hola">
                      <ul class="header-buttons-left ml-0 tableTitle">
                        <li class="dropdown m-l-20">
                          <label for="search-input">
                            <i class="material-icons search-icon">search</i>
                          </label>
                          <input placeholder="Buscar Pedido..." type="text" #filter class="browser-default search-field"
                            aria-label="Search box" />
                        </li>
                      </ul>
                      <div style="float: right">
                        <button class="botonAc" (click)="exportExcel()">
                          <i style="color: green" class="fa-solid fa-file-excel"></i>
                          &nbsp; Excel
                        </button>
                        <button class="botonAc">
                          <i style="color: red" class="fa-solid fa-file-pdf"></i>
                          &nbsp; PDF
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="tableBody">
                <div class="table-responsive">
                  <table class="table table-bpedidoed table-hover">
                    <thead style="margin: -100px">
                      <tr>
                        <th class="text-center">#</th>
                        <th class="text-center">CVE_DOC</th>
                        <th class="text-center" style="width: 160px">
                          IMPORTE
                        </th>
                        <th class="text-center">CVE_CLPV</th>
                        <th class="text-center">Cliente</th>
                        <th class="text-center">CVE_VEND</th>
                        <th class="text-center">Vendedor</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let pedido of pedidos">
                        <td>{{ pedidos.indexOf(pedido) + 1 }}</td>
                        <td class="text-center" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          {{ pedido.CVE_DOC }}
                        </td>
                        <td style="text-align: right" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          <span style="text-align: right">{{ pedido.IMPORTE }}
                          </span>
                        </td>
                        <td class="text-center" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          {{ pedido.CVE_CLPV }}
                        </td>
                        <td (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal" data-bs-target="#viewUser">
                          {{ pedido.NOMBRE[0] }}
                        </td>
                        <td class="text-center" (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal"
                          data-bs-target="#viewUser">
                          {{ pedido.CVE_VEND }}
                        </td>
                        <td (click)="getPedido(pedido.CVE_DOC)" data-bs-toggle="modal" data-bs-target="#viewUser">
                          {{ pedido.NOMBRE[1] }}
                        </td>
                      </tr>
                      <tr rowspan="9" *ngIf="notFound === true">
                        <td colspan="9" class="text-center">Sin Resultados</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</body>
